<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to denoisr • denoisr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to denoisr">
<meta property="og:description" content="denoisr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">denoisr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/denoisr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/StevenGolovkine/denoisr/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="denoisr_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to denoisr</h1>
                        <h4 class="author">Steven Golovkine</h4>
            
            <h4 class="date">2021-11-13</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/StevenGolovkine/denoisr/blob/master/vignettes/denoisr.Rmd"><code>vignettes/denoisr.Rmd</code></a></small>
      <div class="hidden name"><code>denoisr.Rmd</code></div>

    </div>

    
    
<p><em>References:</em></p>
<ul>
<li>J. O. Ramsay, Spencer Graves and Giles Hooker (2020). fda: Functional Data Analysis. R package version 5.1.4. <a href="https://CRAN.R-project.org/package=fda" class="uri">https://CRAN.R-project.org/package=fda</a>
</li>
<li>Happ-Kurz C (2020). “Object-Oriented Software for Functional Data.” <em>Journal of Statistical Software</em>, <em>93</em>(5), 1-38. doi: 10.18637/jss.v093.i05 (URL: <a href="https://doi.org/10.18637/jss.v093.i05" class="uri">https://doi.org/10.18637/jss.v093.i05</a>).</li>
</ul>
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p><code>denoisr</code> is a <strong>R</strong> package which permits to smooth (remove the noise from) functional data by, first, estimate the Hurst coefficient of the underlying generating process.</p>
<p>Functional data to smooth should be defined on a univariate compact, but can be irregularly sampled. <code>denoisr</code> can also be used only for Hurst parameter estimation.</p>
<p><code>denoisr</code> have a support for the package <a href="https://cran.r-project.org/web/packages/funData/index.html"><code>funData</code></a>.</p>
</div>
<div id="model" class="section level2">
<h2 class="hasAnchor">
<a href="#model" class="anchor"></a>Model</h2>
<p>Let <span class="math inline">\(I\)</span> be a compact interval of <span class="math inline">\(\mathbb{R}\)</span>. We assume <span class="math inline">\(X^{(1)}, \dots, X^{(N)}\)</span> to be an independent sample of a random process <span class="math inline">\(X = \left(X_t : t \in I\right)\)</span> with continuous trajectories. For each <span class="math inline">\(1 \leq n \leq N\)</span>, and given a positive integer <span class="math inline">\(M_n\)</span>, let <span class="math inline">\(T_m^{(n)}, 1 \leq m \leq M_n\)</span> be the random observation times for the curve <span class="math inline">\(X^{(n)}\)</span>. These times are obtained as independent copies of a variable <span class="math inline">\(T\)</span> taking values in <span class="math inline">\(I\)</span>. The integers <span class="math inline">\(M_1, \dots, M_N\)</span> represent an independent sample of an integer-valued random variable <span class="math inline">\(M\)</span> with expectation <span class="math inline">\(\mu\)</span>. We assume that the realizations <span class="math inline">\(X\)</span>, <span class="math inline">\(M\)</span> and <span class="math inline">\(T\)</span> are mutually independent. The observations consist of the pairs <span class="math inline">\(\left(Y_m^{(n)}, T_m^{(n)}\right) \in \mathbb{R} \times I\)</span> where <span class="math inline">\(Y_m^{(n)}\)</span> is defined as <span class="math display">\[Y_m^{(n)} = X^{(n)}(T_m^{(n)}) + \varepsilon_m^{(n)}, \quad 1 \leq n \leq N,~ 1 \leq m \leq M_n,\]</span> and <span class="math inline">\(\varepsilon_m^{(n)}\)</span> are independent copies of a centered error variable <span class="math inline">\(\varepsilon\)</span>.</p>
<p>Let <span class="math inline">\(t_0 \in I\)</span> an arbitrarily fixed piont. The aim is to estimate <span class="math inline">\(X^{(1)}(t_0), \dots, X^{(N)}(t_0)\)</span>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Load packages</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/StevenGolovkine/denoisr">denoisr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ClaraHapp/funData">funData</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hadley/reshape">reshape2</a></span><span class="op">)</span></code></pre></div>
</div>
<div id="example-on-temperature-data" class="section level2">
<h2 class="hasAnchor">
<a href="#example-on-temperature-data" class="anchor"></a>Example on temperature data</h2>
<p>The Canadian temperature data correspond to the daily temperature at <span class="math inline">\(35\)</span> different locations in Canada averaged over 1960 to 1994. This dataset is included in the package <a href="https://CRAN.R-project.org/package=fda"><code>fda</code></a>.</p>
<p>This section performs the smoothing of the Canadian temperature Weather data.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Load data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"canadian_temperature_daily"</span><span class="op">)</span></code></pre></div>
<p>This package manipulates lists to define functional data. So, functions are provided to convert it as functional data object defined in the package <a href="https://cran.r-project.org/web/packages/funData/index.html"><code>funData</code></a>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Convert list to funData object</span>
<span class="va">data_fd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/list2funData.html">list2funData</a></span><span class="op">(</span><span class="va">canadian_temperature_daily</span><span class="op">)</span></code></pre></div>
<p>So, we can use all the available function for <code>funData</code> object. As an example, we can plot the data with the <code>ggplot2</code> style.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Plot of the data</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="va">data_fd</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">'Daily Temperature Data'</span>,
       x <span class="op">=</span> <span class="st">'Normalized Day of Year'</span>,
       y <span class="op">=</span> <span class="st">'Temperature in °C'</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="denoisr_files/figure-html/plot_data-1.png" width="672"></p>
<p>The smoothing of the curves can be performed using the function <code>smooth_curves</code>. It accepts the parameter <code>t0_list</code> which correspond to the times where we want to estimate the bandwidth and the parameter <code>k0_list</code> which is the considered neighborhood.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Smooth the data</span>
<span class="va">smooth_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/smooth_curves.html">smooth_curves</a></span><span class="op">(</span><span class="va">canadian_temperature_daily</span>, 
                             t0_list <span class="op">=</span> <span class="fl">0.5</span>, 
                             k0_list <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></code></pre></div>
<p>Then, we can plot the smoothed data.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Plot of the smoothed data</span>
<span class="va">smooth_data_fd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/list2funData.html">list2funData</a></span><span class="op">(</span><span class="va">smooth_data</span><span class="op">$</span><span class="va">smooth</span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="va">smooth_data_fd</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">'Smooth Daily Temperature Data'</span>,
       x <span class="op">=</span> <span class="st">'Normalized Day of Year'</span>,
       y <span class="op">=</span> <span class="st">'Temperature in °C'</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="denoisr_files/figure-html/plot_data2-1.png" width="672"></p>
<p>Finally, we show on particular curve along its smoothed version to look at the impact of smoothing.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Plot one realisation of the smoothed data</span>
<span class="va">montreal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>t <span class="op">=</span> <span class="va">canadian_temperature_daily</span><span class="op">$</span><span class="va">Montreal</span><span class="op">$</span><span class="va">t</span>,
                   Data <span class="op">=</span> <span class="va">canadian_temperature_daily</span><span class="op">$</span><span class="va">Montreal</span><span class="op">$</span><span class="va">x</span>,
                   Smooth <span class="op">=</span> <span class="va">smooth_data</span><span class="op">$</span><span class="va">smooth</span><span class="op">$</span><span class="va">Montreal</span><span class="op">$</span><span class="va">x</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu">reshape2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">'t'</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/funData/man/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">montreal</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">t</span>, y <span class="op">=</span> <span class="va">value</span>, color <span class="op">=</span> <span class="va">variable</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">'Example of Montreal'</span>,
       x <span class="op">=</span> <span class="st">'Normalized Day of Year'</span>,
       y <span class="op">=</span> <span class="st">'Temperature in °C'</span>,
       color <span class="op">=</span> <span class="st">''</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="denoisr_files/figure-html/plot_data3-1.png" width="672"></p>
</div>
<div id="example-on-simulated-data" class="section level2">
<h2 class="hasAnchor">
<a href="#example-on-simulated-data" class="anchor"></a>Example on simulated data</h2>
<p>We will do the same analysis on some simulated datasets.</p>
<div id="on-fractional-brownian-motion" class="section level3">
<h3 class="hasAnchor">
<a href="#on-fractional-brownian-motion" class="anchor"></a>On fractional brownian motion</h3>
<p>First, we will do the analysis on a dataset of fractional brownian motion. A fractional brownian motion is a continuous-time Gaussian process <span class="math inline">\(B_H(t)\)</span> on <span class="math inline">\([0, 1]\)</span>, such that:</p>
<ul>
<li><p><span class="math inline">\(B_H(0) = 0\)</span></p></li>
<li><p><span class="math inline">\(\mathbb{E}(B_H(t)) = 0, \quad \forall t \in [0, 1]\)</span></p></li>
<li><p><span class="math inline">\(\mathbb{E}(B_H(s)B_H(t)) = \frac{1}{2}\left(\lvert s\rvert^{2H} + \lvert t\rvert^{2H} - \lvert t - s\rvert^{2H}\right)\)</span> where <span class="math inline">\(H\)</span> is a real number in <span class="math inline">\((0, 1)\)</span>, named Hurst parameter.</p></li>
</ul>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Simulate some data</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span>
<span class="va">fractional_brownian</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_fractional_brownian.html">generate_fractional_brownian</a></span><span class="op">(</span>N <span class="op">=</span> <span class="fl">100</span>, M <span class="op">=</span> <span class="fl">350</span>, 
                                                    H <span class="op">=</span> <span class="fl">0.5</span>, sigma <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Smooth the data</span>
<span class="va">smooth_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/smooth_curves.html">smooth_curves</a></span><span class="op">(</span><span class="va">fractional_brownian</span>, 
                             t0_list <span class="op">=</span> <span class="fl">0.5</span>, 
                             k0_list <span class="op">=</span> <span class="fl">14</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Estimation of the Hurst coefficient</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">smooth_data</span><span class="op">$</span><span class="va">parameter</span><span class="op">$</span><span class="va">H0</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.5035138</span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Plot a particular observation</span>
<span class="va">obs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>t <span class="op">=</span> <span class="va">fractional_brownian</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">t</span>,
              Noisy <span class="op">=</span> <span class="va">fractional_brownian</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">x</span>,
              Truth <span class="op">=</span> <span class="va">fractional_brownian</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">x_true</span>,
              Smooth <span class="op">=</span> <span class="va">smooth_data</span><span class="op">$</span><span class="va">smooth</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">x</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu">reshape2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">'t'</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/funData/man/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">obs</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">t</span>, y <span class="op">=</span> <span class="va">value</span>, color <span class="op">=</span> <span class="va">variable</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">'Fractional brownian motion'</span>,
       x <span class="op">=</span> <span class="st">'Normalized time'</span>,
       y <span class="op">=</span> <span class="st">'Value'</span>,
       color <span class="op">=</span> <span class="st">''</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="denoisr_files/figure-html/plot_brown-1.png" width="672"></p>
</div>
<div id="on-piecewise-fractional-brownian-motion" class="section level3">
<h3 class="hasAnchor">
<a href="#on-piecewise-fractional-brownian-motion" class="anchor"></a>On piecewise fractional brownian motion</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span>
<span class="va">piece_frac_brown</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_piecewise_fractional_brownian.html">generate_piecewise_fractional_brownian</a></span><span class="op">(</span>N <span class="op">=</span> <span class="fl">150</span>, M <span class="op">=</span> <span class="fl">350</span>, 
                                                           H <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="fl">0.8</span><span class="op">)</span>, 
                                                           sigma <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Smooth the data</span>
<span class="va">smooth_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/smooth_curves.html">smooth_curves</a></span><span class="op">(</span><span class="va">piece_frac_brown</span>, 
                             t0_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.15</span>, <span class="fl">0.5</span>, <span class="fl">0.85</span><span class="op">)</span>, 
                             k0_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">14</span>, <span class="fl">14</span>, <span class="fl">14</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Estimation of the Hurst coefficient</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">smooth_data</span><span class="op">$</span><span class="va">parameter</span><span class="op">$</span><span class="va">H0</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.1634871 0.6689895 0.7037816</span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Plot a particular observation</span>
<span class="va">obs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>t <span class="op">=</span> <span class="va">piece_frac_brown</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">t</span>,
              Noisy <span class="op">=</span> <span class="va">piece_frac_brown</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">x</span>,
              Truth <span class="op">=</span> <span class="va">piece_frac_brown</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">x_true</span>,
              Smooth <span class="op">=</span> <span class="va">smooth_data</span><span class="op">$</span><span class="va">smooth</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">x</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu">reshape2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">'t'</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/funData/man/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">obs</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">t</span>, y <span class="op">=</span> <span class="va">value</span>, color <span class="op">=</span> <span class="va">variable</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">'Piecewise fractional brownian motion'</span>,
       x <span class="op">=</span> <span class="st">'Normalized time'</span>,
       y <span class="op">=</span> <span class="st">'Value'</span>,
       color <span class="op">=</span> <span class="st">''</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="denoisr_files/figure-html/plot_piece_brown-1.png" width="672"></p>
</div>
<div id="on-integrated-fractional-brownian-motion" class="section level3">
<h3 class="hasAnchor">
<a href="#on-integrated-fractional-brownian-motion" class="anchor"></a>On integrated fractional brownian motion</h3>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Simulate some data</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span>
<span class="va">inte_fractional_brownian</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_integrate_fractional_brownian.html">generate_integrate_fractional_brownian</a></span><span class="op">(</span>N <span class="op">=</span> <span class="fl">100</span>, M <span class="op">=</span> <span class="fl">350</span>, H <span class="op">=</span> <span class="fl">0.5</span>, sigma <span class="op">=</span> <span class="fl">0.025</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Smooth the data</span>
<span class="va">smooth_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/smooth_curves_regularity.html">smooth_curves_regularity</a></span><span class="op">(</span><span class="va">inte_fractional_brownian</span>, 
                                        t0 <span class="op">=</span> <span class="fl">0.5</span>, k0 <span class="op">=</span> <span class="fl">14</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Estimation of the Hurst coefficient</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">smooth_data</span><span class="op">$</span><span class="va">parameter</span><span class="op">$</span><span class="va">H0</span><span class="op">)</span>
<span class="co">#&gt; [1] 1.533345</span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Plot a particular observation</span>
<span class="va">obs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>t <span class="op">=</span> <span class="va">inte_fractional_brownian</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">t</span>,
              Noisy <span class="op">=</span> <span class="va">inte_fractional_brownian</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">x</span>,
              Truth <span class="op">=</span> <span class="va">inte_fractional_brownian</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">x_true</span>,
              Smooth <span class="op">=</span> <span class="va">smooth_data</span><span class="op">$</span><span class="va">smooth</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">x</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu">reshape2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">'t'</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/funData/man/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">obs</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">t</span>, y <span class="op">=</span> <span class="va">value</span>, color <span class="op">=</span> <span class="va">variable</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">'Integreted Fractional brownian motion'</span>,
       x <span class="op">=</span> <span class="st">'Normalized time'</span>,
       y <span class="op">=</span> <span class="st">'Value'</span>,
       color <span class="op">=</span> <span class="st">''</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="denoisr_files/figure-html/plot_inte_brown-1.png" width="672"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Steven Golovkine.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
